<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.25.1" />
  <meta name="author" content="Gaurav Mahajan">
  <meta name="description" content="PhD. Student">

  
  
  
    
  
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/~gmahajan/css/hugo-academic.css">
  
  <link rel="stylesheet" href="/~gmahajan/css/custom.css">
  

  

  <link rel="alternate" href="http://cseweb.ucsd.edu/~gmahajan/index.xml" type="application/rss+xml" title="Gaurav Mahajan">
  <link rel="feed" href="http://cseweb.ucsd.edu/~gmahajan/index.xml" type="application/rss+xml" title="Gaurav Mahajan">

  <link rel="icon" type="image/png" href="/~gmahajan/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/~gmahajan/img/apple-touch-icon.png">

  <link rel="canonical" href="http://cseweb.ucsd.edu/~gmahajan/post/least-squares-and-nearest-neighbors/">

  

  <title>From Least Squares to Nearest Neighbors | Gaurav Mahajan</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/~gmahajan/">Gaurav Mahajan</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/~gmahajan/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/~gmahajan/#news">
            
            <span>News</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/~gmahajan/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/~gmahajan/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">From Least Squares to Nearest Neighbors</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2017-08-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Tue, Aug 1, 2017
    </time>
  </span>

  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/~gmahajan/tags/regression">regression</a
    >
    
  </span>
  
  

  
  

  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>In this post, we will evaluate two simple but powerful prediction methods: the linear model fit by least squares and the \(k\)-nearest-neighbor prediction rule on a simple regression problem.<br>
<a href="https://github.com/gmahajanml/linear-to-nearest">Link to code</a></p>

<p></p>

<p>We will see how the linear model makes huge assumptions about structure and yields stable but possibly inaccurate predictions. The method of \(k\)-nearest neighbors, however, makes very mild structural assumptions: its predictions are often accurate but can be unstable.</p>

<h2 id="training-data">Training Data</h2>

<p>Consider the two possible scenarios:</p>

<p><strong>Scenario 1:</strong> The training data in each class were generated from bivariate Gaussian distribution with uncorrelated components and different means.</p>

<p><strong>Scenario 2:</strong> The training data in each class came from a mixture of 10 low-variance Gaussian distributions, with individual means themselves distributed as Gaussian.</p>

<p>We first create training data for \(Y=1\), denoted by \(X_{pos}\) and
\(Y=-1\), denoted by \(X_{neg}\).</p>

<p><figure><img src="/img/linear_nearest/scenario1.png" alt="" title="Scenario 1"><figcaption>Scenario 1</figcaption></figure></p>

<p><figure><img src="/img/linear_nearest/scenario2.png" alt="" title="Scenario 2"><figcaption>Scenario 2</figcaption></figure></p>

<h2 id="results-for-least-squares">Results for Least Squares</h2>

<p>This is how least squares performs on both scenarios.</p>

<p><figure><img src="/img/linear_nearest/scenario1_linear.png" alt="" title="Least squares on Scenario 1"><figcaption>Least squares on Scenario 1</figcaption></figure></p>

<p><figure><img src="/img/linear_nearest/scenario2_linear.png" alt="" title="Least squares on Scenario 2"><figcaption>Least squares on Scenario 2</figcaption></figure></p>

<h2 id="results-for-nearest-neighbors">Results for Nearest Neighbors</h2>

<p>This is how nearest neighbors performs for k=10.</p>

<p><figure><img src="/img/linear_nearest/scenario1_nearest.png" alt="" title="Nearest Neighbors on Scenario 1"><figcaption>Nearest Neighbors on Scenario 1</figcaption></figure></p>

<p><figure><img src="/img/linear_nearest/scenario2_nearest.png" alt="" title="Nearest Neighbors on Scenario 2"><figcaption>Nearest Neighbors on Scenario 2</figcaption></figure></p>

<h2 id="conclusion">Conclusion</h2>

<p>We can actually develop some theory that provides a framework for developing models such as those discussed informally so far. As discussed in another post, for squared error loss function, the regression function is <span  class="math">\(f(x)=E(Y|X=x)\)</span></p>

<p>The nearest-neighbor methods attempt to directly implement this recipe using the training data. At each point \(x\), we might ask for the average of all those \(y_is\) with input \(x_i=x\). Since there is typically at most one observation at any point \(x\), we settle for
<span  class="math">\(\hat{f}(x)=Ave(y_i|x_i \in N_k(x))\)</span>
where \(&quot;Ave&quot;\) denotes average, and \(N_k(x)\) is the neighborhood
containing the \(k\) points in \(T\) closest to \(x\). Two approximations are happening here:</p>

<ul>
<li>expectation is approximated by averaging over sample data;</li>
<li>conditioning at a point is related to conditioning on some region &quot;close&quot; to the target point<br></li>
</ul>

<p>How does linear regression fit into this framework? The simplest explanation is that one assumes that the regression function \(f(x)\) is approximately linear in its arguments: <span  class="math">\(f(x) \approx x^T\beta\)</span>.
This is a model-based approach- we specify a model for the regression function. Plugging this linear model for \(f(x)\) into \(EPE\) and differentiating we can solve for \(\beta\) theoretically:
<span  class="math">\(\beta = (E(XX^T))^{-1} E(XY)\)</span>.</p>

<p>Note we have not conditioned on \(X\); rather we have used our knowledge of the functional relationship to <em>pool</em> over values of \(X\). The least squares solution amounts to replacing the expectation b averages overs the training data.</p>

<p>So both \(k\)-nearest neighbors and least squares end up approximating
conditional expectations by averages. But they differ dramatically in terms
of model assumptions:</p>

<ul>
<li>Least squares assumes f(x) is well approximated by a globally linear
function. The linear decision boundary from least squares is very smooth, and apparently
stable to fit. More suitable for scenario 1.</li>
<li>k-nearest neighbors assumes f(x) is well approximated by a locally constant function. Thus, it is wiggly and unstable. It however
does not rely on any stringent assumptions about the underlying data, and can adapt
to any situation. More suitable for scenario 2.</li>
</ul>
    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    

    
    <li class="next"><a href="http://cseweb.ucsd.edu/~gmahajan/post/first-few-weeks-in-phd/">First Few Weeks in PhD <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gmahajanml" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Gaurav Mahajan 

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/~gmahajan/js/hugo-academic.js"></script>
    

    
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ 
        tex2jax: { 
              inlineMath: [['$','$'], ['\\(','\\)']],
              displayMath: [['$$','$$']],
              processEscapes: true,
              processEnvironments: true
            },
        TeX: {
          equationNumbers: {
              autoNumber: "AMS"
            }
        }
        });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

